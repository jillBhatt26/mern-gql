import{n as q,o as b,p as v,q as W,s as F,t as S,v as U,w as j,x as Q,y as D,z as V,B as z,C as G,E as B,G as w,H as T,J as A}from"./index-BoMZq1zZ.js";var _=!1,J="useSyncExternalStore",K=q[J],H=K||function(r,e,t){var n=e();globalThis.__DEV__!==!1&&!_&&n!==e()&&(_=!0,globalThis.__DEV__!==!1&&b.error(68));var a=v.useState({inst:{value:n,getSnapshot:e}}),u=a[0].inst,c=a[1];return W?v.useLayoutEffect(function(){Object.assign(u,{value:n,getSnapshot:e}),k(u)&&c({inst:u})},[r,n,e]):Object.assign(u,{value:n,getSnapshot:e}),v.useEffect(function(){return k(u)&&c({inst:u}),r(function(){k(u)&&c({inst:u})})},[r]),n};function k(r){var e=r.value,t=r.getSnapshot;try{return e!==t()}catch{return!0}}var X=Symbol.for("apollo.hook.wrappers");function Y(r,e,t){var n=t.queryManager,a=n&&n[X],u=a&&a[r];return u?u(e):e}var Z=Object.prototype.hasOwnProperty;function C(){}var P=Symbol();function dr(r,e){return e===void 0&&(e=Object.create(null)),Y("useQuery",$,F(e&&e.client))(r,e)}function $(r,e){var t=er(r,e),n=t.result,a=t.obsQueryFields;return v.useMemo(function(){return S(S({},n),a)},[n,a])}function rr(r,e,t,n,a){function u(s){var f;V(e,z.Query);var p={client:r,query:e,observable:n&&n.getSSRObservable(a())||r.watchQuery(x(void 0,r,t,a())),resultData:{previousData:(f=s==null?void 0:s.resultData.current)===null||f===void 0?void 0:f.data}};return p}var c=v.useState(u),i=c[0],o=c[1];function d(s){var f,p;Object.assign(i.observable,(f={},f[P]=s,f));var h=i.resultData;o(S(S({},i),{query:s.query,resultData:Object.assign(h,{previousData:((p=h.current)===null||p===void 0?void 0:p.data)||h.previousData,current:void 0})}))}if(r!==i.client||e!==i.query){var y=u(i);return o(y),[y,d]}return[i,d]}function er(r,e){var t=F(e.client),n=v.useContext(U()).renderPromises,a=!!n,u=t.disableNetworkFetches,c=e.ssr!==!1&&!e.skip,i=e.partialRefetch,o=ur(t,r,e,a),d=rr(t,r,e,n,o),y=d[0],s=y.observable,f=y.resultData,p=d[1],h=o(s);ar(f,s,t,e,h);var O=v.useMemo(function(){return sr(s)},[s]);nr(s,n,c);var E=tr(f,s,t,e,h,u,i,a,{onCompleted:e.onCompleted||C,onError:e.onError||C});return{result:E,obsQueryFields:O,observable:s,resultData:f,client:t,onQueryExecuted:p}}function tr(r,e,t,n,a,u,c,i,o){var d=v.useRef(o);v.useEffect(function(){d.current=o});var y=(i||u)&&n.ssr===!1&&!n.skip?L:n.skip||a.fetchPolicy==="standby"?N:void 0,s=r.previousData,f=v.useMemo(function(){return y&&I(y,s,e,t)},[t,e,y,s]);return H(v.useCallback(function(p){if(i)return function(){};var h=function(){var g=r.current,l=e.getCurrentResult();g&&g.loading===l.loading&&g.networkStatus===l.networkStatus&&Q(g.data,l.data)||m(l,r,e,t,c,p,d.current)},O=function(g){if(E.current.unsubscribe(),E.current=e.resubscribeAfterError(h,O),!Z.call(g,"graphQLErrors"))throw g;var l=r.current;(!l||l&&l.loading||!Q(g,l.error))&&m({data:l&&l.data,error:g,loading:!1,networkStatus:w.error},r,e,t,c,p,d.current)},E={current:e.subscribe(h,O)};return function(){setTimeout(function(){return E.current.unsubscribe()})}},[u,i,e,r,c,t]),function(){return f||R(r,e,d.current,c,t)},function(){return f||R(r,e,d.current,c,t)})}function nr(r,e,t){e&&t&&(e.registerSSRObservable(r),r.getCurrentResult().loading&&e.addObservableQueryPromise(r))}function ar(r,e,t,n,a){var u;e[P]&&!Q(e[P],a)&&(e.reobserve(x(e,t,n,a)),r.previousData=((u=r.current)===null||u===void 0?void 0:u.data)||r.previousData,r.current=void 0),e[P]=a}function ur(r,e,t,n){t===void 0&&(t={});var a=t.skip;t.ssr,t.onCompleted,t.onError;var u=t.defaultOptions,c=j(t,["skip","ssr","onCompleted","onError","defaultOptions"]);return function(i){var o=Object.assign(c,{query:e});return n&&(o.fetchPolicy==="network-only"||o.fetchPolicy==="cache-and-network")&&(o.fetchPolicy="cache-first"),o.variables||(o.variables={}),a?(o.initialFetchPolicy=o.initialFetchPolicy||o.fetchPolicy||M(u,r.defaultOptions),o.fetchPolicy="standby"):o.fetchPolicy||(o.fetchPolicy=(i==null?void 0:i.options.initialFetchPolicy)||M(u,r.defaultOptions)),o}}function x(r,e,t,n){var a=[],u=e.defaultOptions.watchQuery;return u&&a.push(u),t.defaultOptions&&a.push(t.defaultOptions),a.push(G(r&&r.options,n)),a.reduce(B)}function m(r,e,t,n,a,u,c){var i=e.current;i&&i.data&&(e.previousData=i.data),!r.error&&T(r.errors)&&(r.error=new A({graphQLErrors:r.errors})),e.current=I(cr(r,t,a),e.previousData,t,n),u(),ir(r,i==null?void 0:i.networkStatus,c)}function ir(r,e,t){if(!r.loading){var n=or(r);Promise.resolve().then(function(){n?t.onError(n):r.data&&e!==r.networkStatus&&r.networkStatus===w.ready&&t.onCompleted(r.data)}).catch(function(a){globalThis.__DEV__!==!1&&b.warn(a)})}}function R(r,e,t,n,a){return r.current||m(e.getCurrentResult(),r,e,a,n,function(){},t),r.current}function M(r,e){var t;return(r==null?void 0:r.fetchPolicy)||((t=e==null?void 0:e.watchQuery)===null||t===void 0?void 0:t.fetchPolicy)||"cache-first"}function or(r){return T(r.errors)?new A({graphQLErrors:r.errors}):r.error}function I(r,e,t,n){var a=r.data;r.partial;var u=j(r,["data","partial"]),c=S(S({data:a},u),{client:n,observable:t,variables:t.variables,called:r!==L&&r!==N,previousData:e});return c}function cr(r,e,t){return r.partial&&t&&!r.loading&&(!r.data||Object.keys(r.data).length===0)&&e.options.fetchPolicy!=="cache-only"?(e.refetch(),S(S({},r),{loading:!0,networkStatus:w.refetch})):r}var L=D({loading:!0,data:void 0,error:void 0,networkStatus:w.loading}),N=D({loading:!1,data:void 0,error:void 0,networkStatus:w.ready});function sr(r){return{refetch:r.refetch.bind(r),reobserve:r.reobserve.bind(r),fetchMore:r.fetchMore.bind(r),updateQuery:r.updateQuery.bind(r),startPolling:r.startPolling.bind(r),stopPolling:r.stopPolling.bind(r),subscribeToMore:r.subscribeToMore.bind(r)}}export{dr as u};
