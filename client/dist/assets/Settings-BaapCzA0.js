import{j as e,M as i,r as s,u as C,b as x,d as E,U as F,N as A,F as M,D as I}from"./index-Bz4YA_Hw.js";import{F as v}from"./User-B62DeXNW.js";import{C as B}from"./ConfirmDeleteModal-ClVVREVd.js";const O=({showUpdateUserConfirmModal:a,setShowUpdateUserConfirmModal:u,handleUpdateUser:l})=>e.jsxs(i,{isOpen:a,onClose:()=>u(!1),onConfirm:l,children:[e.jsxs(i.Header,{children:[e.jsx(i.Header.Title,{children:e.jsx("p",{className:"text-warning",children:"Caution!"})}),e.jsx(i.Header.CloseButton,{})]}),e.jsx(i.Body,{children:e.jsx("p",{className:"ml-5 mb-4",children:"Your account will be updated. You'll have to login again. Wish to continue?"})}),e.jsxs(i.Footer,{className:"d-flex justify-center",children:[e.jsx(i.Footer.ConfirmButton,{className:"btn btn-warning",children:"Update Account"}),e.jsx(i.Footer.CancelButton,{children:"Cancel"})]})]}),T=()=>{const[a,u]=s.useState(""),[l,f]=s.useState(""),[c,m]=s.useState(""),[p,b]=s.useState({}),[d,o]=s.useState(null),[h,n]=s.useState(!1),[U,j]=s.useState(!1),g=C(),N=x(t=>t.authUser),S=x(t=>t.unsetAuthUser),[y,{loading:w}]=E(F,{variables:{updateUserInputs:{}},onCompleted:t=>{if(t.UpdateUser&&g)return S(),g("/login",{replace:!0})},onError:t=>{if(t){const r=t.toString().split(":").pop();o(r)}},update:t=>{t.writeQuery({query:v,data:{FetchActiveUser:null}})}});s.useEffect(()=>{n(w||d!==null)},[w,d]);const D=async t=>{t.preventDefault();const r={};if(l&&l.trim()&&(r.email=l.trim()),a&&a.trim()&&(r.username=a.trim()),c&&c.trim()&&(r.password=c.trim()),!Object.keys(r).length)return o("Enter any one value to update user!");if(r.email===N.email)return o("New email should be different than existing one");if(r.username===N.username)return o("New username should be different than existing one");b(r),j(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-center",children:"Update Account"}),d&&e.jsxs("div",{className:"alert alert-dismissible alert-danger mt-5",children:[e.jsx("button",{type:"button",className:"btn-close",onClick:()=>o(null)}),d]}),e.jsxs("form",{noValidate:!0,autoComplete:"off",onSubmit:D,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"usernameOrEmail",className:"form-label mt-4",children:"New Username"}),e.jsx("input",{type:"email",className:"form-control",id:"username",placeholder:"New username",onChange:t=>u(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"usernameOrEmail",className:"form-label mt-4",children:"New Email"}),e.jsx("input",{type:"email",className:"form-control",id:"email",placeholder:"New email",onChange:t=>f(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"usernameOrEmail",className:"form-label mt-4",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",id:"password",placeholder:"New password",onChange:t=>m(t.target.value)})]}),e.jsx("div",{className:"d-grid gap-2 mt-5",children:e.jsx("button",{className:`btn btn-lg btn-outline-warning border-warning ${h??"disabled"}`,type:"submit",disabled:h,children:"Update account"})})]}),e.jsx(O,{showUpdateUserConfirmModal:U,setShowUpdateUserConfirmModal:j,handleUpdateUser:()=>{y({variables:{updateUserInputs:{...p}}})}})]})},R=()=>{const[a,u]=s.useState(null),[l,f]=s.useState(!1),[c,m]=s.useState(!1),p=C(),b=x(n=>n.unsetAuthUser),[d,{loading:o}]=E(I,{onCompleted:n=>{if(n.DeleteUser&&p)return b(),p("/login",{replace:!0})},onError:n=>{if(n){const U=n.toString().split(":").pop();u(U)}},update:n=>{n.writeQuery({query:v,data:{FetchActiveUser:null}})}});s.useEffect(()=>{f(o||a!==null)},[o,a]);const h=()=>{d()};return e.jsxs(e.Fragment,{children:[e.jsx(A,{}),e.jsx("div",{className:"container",children:e.jsxs("div",{className:"container mt-5 col-12 col-md-8 col-lg-4",children:[a&&e.jsxs("div",{className:"alert alert-dismissible alert-danger mt-5",children:[e.jsx("button",{type:"button",className:"btn-close",onClick:()=>u(null)}),a]}),e.jsx(T,{}),e.jsx("div",{className:"d-grid my-3",children:e.jsx("button",{type:"button",className:`btn btn-lg btn-outline-danger border-danger ${l&&"disabled"}`,onClick:()=>m(!0),disabled:l,children:"Delete account"})})]})}),e.jsx(M,{}),e.jsx(B,{isOpen:c,onClose:()=>m(!1),onConfirm:h,message:"This action is irreversible. Your account and all your data will be permanently deleted. Wish to continue?",confirmButtonLabel:"Delete Account"})]})};export{R as default};
