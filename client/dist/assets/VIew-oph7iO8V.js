const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BoMZq1zZ.js","assets/index-DTCJZlBg.css"])))=>i.map(i=>d[i]);
import{r as s,a as h,h as M,u as P,d as U,i as k,j as e,N as Q,I as T,F as A,_ as G}from"./index-BoMZq1zZ.js";import{C as R}from"./ConfirmDeleteModal-DpPEFLpJ.js";import{a as q,F as b}from"./Image-BxRO9_G3.js";import{u as H}from"./useQuery-Bzupd6aO.js";const O=s.lazy(()=>G(()=>import("./index-BoMZq1zZ.js").then(o=>o.K),__vite__mapDeps([0,1]))),K=()=>{const[o,l]=s.useState(null),[p,E]=s.useState(!1),[a,v]=s.useState(-1),[c,g]=s.useState(null),[I,f]=s.useState(null),[j,x]=s.useState(!1),r=h(t=>t.userImages),_=h(t=>t.removeUserImage),n=M(),i=P(),{data:m,error:d,loading:N}=H(q,{variables:{id:n.id}}),[y,{loading:C}]=U(k,{variables:{id:n.id},onCompleted:t=>{if(t.DeleteImage)return _(n.id),i("/gallery")},onError:t=>{const u=t.toString().split(":").pop();l(u)},update:(t,u)=>{if(u.data.DeleteImage){const{FetchUserImagesQuery:w}=t.readQuery({query:b}),F=w.filter(L=>L._id!==n.id);t.writeQuery({query:b,data:{FetchUserImagesQuery:F}})}}});s.useEffect(()=>{if(d){const t=d.toString().split(":").pop();l(t)}},[d]),s.useEffect(()=>{v(r.findIndex(t=>t._id===n.id))},[n.id,r]),s.useEffect(()=>{if(a<=0)return g(null);g(r[a-1]._id)},[a,r]),s.useEffect(()=>{if(a>=r.length-1)return f(null);f(r[a+1]._id)},[a,r]);const S=()=>{if(c!==null)return i(`/view/${c}`)},D=()=>{if(I!==null)return i(`/view/${I}`)};return N||C?e.jsx(O,{}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsxs("div",{className:"container mt-5",children:[o&&e.jsxs("div",{className:"alert alert-dismissible alert-danger mt-5",children:[e.jsx("button",{type:"button",className:"btn-close",onClick:()=>l(null)}),o]}),e.jsx("div",{className:"col-sm-12 col-md-10 mx-auto d-flex justify-content-center",children:m&&e.jsx(T,{src:m.FetchUserImage.url,alt:m.FetchUserImage.cloudImageName,onLoad:()=>E(!0)})}),p&&e.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-center mt-5 gap-3",children:[e.jsx("button",{className:"btn btn-warning",onClick:()=>i("/gallery"),children:"Gallery"}),e.jsx("button",{className:"btn btn-info",disabled:a<=0,onClick:S,children:"Previous"}),e.jsx("button",{className:"btn btn-info",disabled:a>=r.length-1,onClick:D,children:"Next"}),e.jsx("button",{className:"btn btn-danger",onClick:()=>x(!0),children:"Delete"})]})]}),e.jsx(R,{isOpen:j,onClose:()=>x(!1),onConfirm:()=>y(),message:"This action is irreversible. Your image will be permanently deleted. Wish to proceed?",confirmButtonLabel:"Delete Image"}),e.jsx(A,{})]})};export{K as default};
